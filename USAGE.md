# Prism Vote - 使い方ガイド

## 🚀 起動方法

> **⚠️ エラーが出る場合は [START.md](START.md) を必ず確認してください！**

### **正しい起動手順**

```bash
# 1. フロントエンド依存関係がインストール済みか確認
npm install

# 2. Tauriアプリを起動（これだけでOK！）
npm run tauri dev
```

**重要:** `npm run tauri dev` を使ってください。これでフロントエンドとバックエンドが両方起動します。

**絶対にやってはいけないこと:**
- ❌ `npm run dev` だけを実行（Tauriが起動しません）
- ❌ ブラウザで http://localhost:1420 を直接開く（IPC エラーが出ます）

### **よくあるエラーと解決方法**

#### ❌ `window.__TAURI_IPC__ is not a function`

**原因:** ブラウザで直接開いている、またはViteのみ起動している

**解決策:**
```bash
# 間違ったプロセスを終了
Ctrl + C

# 正しい起動コマンドを使用
npm run tauri dev
```

**詳細な解決方法は [START.md](START.md) を参照してください。**

#### ❌ `icons/icon.ico not found`

**原因:** アイコンファイルが未作成

**解決策:** 開発モードでは無視してOK（すでに修正済み）

---

## 📱 使用方法

### 1️⃣ **投票を作成する**

1. アプリ起動後、ホーム画面が表示されます
2. **「➕ 新規投票作成」** ボタンをクリック

3. **投票情報を入力:**
   - **タイトル**: 「ランチどこ行く？」
   - **選択肢1**: 「🍜 ラーメン」
   - **選択肢2**: 「🍛 カレー」
   - **選択肢3**: 「🍣 寿司」
   - **締切時間**: 24時間後

4. **「投票を作成」** ボタンをクリック

5. ✅ 投票が作成され、ホーム画面に表示されます！

---

### 2️⃣ **投票する**

1. ホーム画面の **進行中の投票** カードをクリック

2. 投票画面が表示されます
   - タイトル表示
   - 締切時間（例: 24時間後）
   - 投票数（例: 0/20人）

3. **選択肢をクリック** してラジオボタンを選択
   - ○ 🍜 ラーメン
   - ● 🍛 カレー ← 選択中
   - ○ 🍣 寿司

4. **「🗳️ 投票する」** ボタンをクリック

5. ✅ 投票完了！結果画面に自動遷移

**🔒 あなたの投票は完全匿名です**
- ブラインド署名により、誰が何に投票したか追跡不可能
- 個人情報は一切記録されません

---

### 3️⃣ **結果を見る**

1. ホーム画面の **完了した投票** カードをクリック
   （または投票後に自動表示）

2. **結果画面** が表示されます:

```
🏆 結果

1位 🍛 カレー
████████████████░░░░  45% (9票)

2位 🍜 ラーメン
███████████░░░░░░░░░  35% (7票)

3位 🍣 寿司
████████░░░░░░░░░░░░  20% (4票)

━━━━━━━━━━━━━━━━━━━━━━━━

📊 総投票数: 20票
✅ 検証済み: すべての投票が有効
```

3. **アクションボタン:**
   - 📥 結果をエクスポート
   - 🔍 投票を検証

---

### 4️⃣ **設定を変更する**

画面下部の **「設定」** タブをクリック

#### **一般設定**
- ✅ **ダークモード**: トグルスイッチで切替
- ✅ **通知**: 投票終了時の通知ON/OFF

#### **プライバシー設定**
- **匿名ID表示**:
  ```
  anon_x7k9p2m4q8
  ```
  このIDであなたの投票を管理（個人情報とは無関係）

- **「新しいIDを生成」** ボタン:
  - クリックで新しい匿名IDを生成
  - 以前の投票履歴とは切り離されます

#### **ネットワーク情報**
- 接続状態: オフライン/オンライン
- 接続ピア数: 0（P2P機能は今後実装予定）

---

## 🎯 実践例

### シナリオ: チームでランチ投票

**状況:** 5人のチームでランチの場所を決めたい

**手順:**

1. **投票作成（リーダー）**
   ```
   タイトル: 今日のランチどこ行く？
   選択肢:
   - 🍜 駅前ラーメン
   - 🍛 カレーハウス
   - 🍣 回転寿司
   - 🍔 ハンバーガー店
   締切: 2時間後
   ```

2. **投票（全員）**
   - 各メンバーが好きな選択肢を選んで投票
   - 完全匿名なので気兼ねなく投票可能

3. **結果確認**
   ```
   1位 🍛 カレーハウス  40% (2票)
   2位 🍜 駅前ラーメン  40% (2票)
   3位 🍣 回転寿司      20% (1票)
   4位 🍔 ハンバーガー  0%  (0票)
   ```

4. **決定**
   - 同率1位の場合は話し合いで決定
   - または再投票を作成

---

## ⚙️ トラブルシューティング

### **アプリが起動しない**

```bash
# 依存関係を再インストール
npm install

# キャッシュをクリア
rm -rf node_modules dist
npm install

# 再起動
npx tauri dev
```

### **投票が作成できない**

1. ブラウザのコンソールを開く（F12）
2. エラーメッセージを確認
3. `window.__TAURI_IPC__ is not a function` が出る場合:
   - ブラウザで直接開いている → Tauriアプリで開く
   - `npx tauri dev` で起動し直す

### **投票が表示されない**

- Rustバックエンドが起動しているか確認
- コンソールにエラーがないか確認
- アプリを再起動

---

## 🔧 開発者向け

### **ホットリロード**

フロントエンドのコードを変更すると、自動的にリロードされます。

### **デバッグ**

```bash
# Rustバックエンドのログを表示
RUST_LOG=debug npx tauri dev

# フロントエンドのコンソールを開く
右クリック → 検証 → Console
```

### **ビルド**

```bash
# プロダクションビルド
npm run build
npx tauri build

# 実行ファイルの場所
# Windows: src-tauri/target/release/prism-vote-app.exe
# macOS: src-tauri/target/release/bundle/macos/Prism Vote.app
# Linux: src-tauri/target/release/prism-vote-app
```

---

## 💡 Tips

### **投票を効率的に管理**

1. **締切時間を適切に設定**
   - 急ぎの決定: 1-2時間
   - 通常の投票: 24時間
   - 長期アンケート: 1週間（168時間）

2. **選択肢は明確に**
   - 絵文字を使うと視覚的に分かりやすい
   - 具体的な内容を記載

3. **匿名性を活用**
   - 本音の意見を集めたい時に最適
   - 人間関係に配慮した投票が可能

### **プライバシー保護**

- 定期的に匿名IDを再生成
- 投票履歴は自分だけが分かる
- 他人には誰が投票したか絶対に分からない

---

**楽しい投票体験を！** 🎉

何か問題があれば、Issueを立ててください。
